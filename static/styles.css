/* ===== Base + Theme Vars ===== */
:root{
  --bg:#fbfafc; --panel:#ffffff; --muted:#f5f2ff; --line:#ece9f6;
  --text:#0f1222; --sub:#6b6e85;
  --brand:#6d28d9; --brand-2:#7c3aed; --chip:#efe9ff;
  --me:#6d28d9; --meText:#ffffff; --bot:#f3f5fb;
  --shadow:0 10px 30px rgba(0,0,0,.08);
}
html[data-theme="dark"]{
  --bg:#0b0c10; --panel:#101218; --muted:#171a23; --line:#242a38;
  --text:#e7e9f2; --sub:#9aa1b9;
  --brand:#8b5cf6; --brand-2:#a78bfa; --chip:#1d1930;
  --me:#8b5cf6; --meText:#0b0814; --bot:#161a23;
  --shadow:0 10px 30px rgba(0,0,0,.45);
}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font:15px/1.6 "Inter", "SF Pro Text", -apple-system, "Segoe UI", "Roboto", "Helvetica Neue", sans-serif;
  font-weight:400;
  letter-spacing:-0.01em;
}

/* ===== App Layout ===== */
.app{ display:grid; grid-template-columns: 290px 1fr; height:100vh }

/* ===== Sidebar ===== */
.sidebar{
  display:flex; flex-direction:column; padding:12px; gap:12px;
  border-right:1px solid var(--line); background:var(--panel)
}
.side-top{ display:flex; flex-direction:column; gap:12px; min-height:0; }
.new-chat{
  padding:12px 14px; border:none; border-radius:14px;
  background:var(--brand); color:#fff; cursor:pointer;
  box-shadow:var(--shadow);
  font-family:"Inter", "SF Pro Text", -apple-system, "Segoe UI", sans-serif;
  font-weight:500; letter-spacing:-0.01em; font-size:14px;
}
.history{ display:flex; flex-direction:column; gap:8px; overflow:auto; }
.history .item{
  display:flex; align-items:center; gap:8px; justify-content:space-between;
  padding:8px 10px; border-radius:12px; border:1px solid var(--line);
  background:var(--panel); color:var(--text);
}
.history .item.active{ background:var(--muted); border-color:var(--brand) }
.history .title{
  flex:1; text-align:left; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
  border:none; background:transparent; color:inherit; cursor:pointer;
  font-family:"Inter", "SF Pro Text", -apple-system, "Segoe UI", sans-serif;
  font-weight:400; letter-spacing:-0.01em; font-size:13px;
}
.history .del{
  width:28px; height:28px; border-radius:8px; border:1px solid var(--line);
  background:var(--muted); color:var(--text); cursor:pointer;
}
.history .del:hover{ border-color:var(--brand) }

.side-bottom{ margin-top:auto; display:flex; gap:8px }
.side-btn{
  flex:1; padding:10px 12px; border-radius:12px; border:1px solid var(--line);
  background:var(--muted); color:var(--text); cursor:pointer;
}
.side-btn .icon{ margin-right:6px }

/* ===== Topbar ===== */
.topbar{
  display:flex; align-items:center; justify-content:flex-start; gap:14px;
  padding:14px 18px; border-bottom:1px solid var(--line); background:var(--panel)
}
.brand{ display:flex; align-items:center; gap:12px }
.logo{
  width:36px; height:36px; border-radius:50%;
  display:grid; place-items:center; font-weight:800; color:#fff; background:var(--brand);
  box-shadow:var(--shadow);
}
.logo-img{
  width:36px; height:36px; object-fit:contain; display:block;
  border-radius:8px; background:var(--panel); box-shadow:var(--shadow);
}
.logo-img:where(:not([src]),[src=""]){ display:none }
.logo-img:where(:not([src]),[src=""]) + .logo{ display:grid }
.topbar h1{ 
  margin:0; font-size:22px; 
  font-family:"Inter", "SF Pro Display", -apple-system, "Segoe UI", sans-serif;
  font-weight:500; letter-spacing:-0.02em;
}
.sub{ 
  margin:0; color:var(--sub); font-size:13px;
  font-family:"Inter", "SF Pro Text", -apple-system, "Segoe UI", sans-serif;
  font-weight:400; letter-spacing:-0.01em;
}

/* ===== Main Content ===== */
.main{ display:flex; flex-direction:column; min-width:0 }
.content{ display:flex; flex-direction:column; gap:16px; padding:16px; min-height:0 }

/* Hero */
.hero{ text-align:center; padding:18px 8px 4px }
.hero h2{
  margin:6px 0 8px; font-size:42px; line-height:1.1;
  font-family:"Playfair Display", "Times New Roman", serif; 
  letter-spacing:-0.01em; font-weight:500;
}
.hero .muted{ 
  color:var(--sub); margin:0 0 10px; 
  font-family:"Inter", "SF Pro Text", -apple-system, "Segoe UI", sans-serif;
  font-weight:400; letter-spacing:-0.01em;
}

.chips{ display:flex; gap:10px; justify-content:center; flex-wrap:wrap }
.chip{
  padding:10px 14px; border-radius:999px; border:1px solid var(--line);
  background:var(--chip); color:var(--text); cursor:pointer;
  font-family:"Inter", "SF Pro Text", -apple-system, "Segoe UI", sans-serif;
  font-weight:400; letter-spacing:-0.01em; font-size:14px;
}
.chip:hover{ border-color:var(--brand); background:color-mix(in srgb, var(--chip) 70%, var(--brand-2)) }

.burst-logo{
  width: 22px;
  height: 22px;
  object-fit: contain;
  display: inline-block;
  filter: drop-shadow(0 2px 6px rgba(109,40,217,.25));
  margin-bottom: 6px;
}

/* Chat Card */
.card{ background:var(--panel); border-radius:16px; box-shadow:var(--shadow); overflow:hidden }
.chat-card{ display:flex; flex-direction:column }
.feed{
  flex:1; min-height:260px; padding:18px; overflow:auto;
  background:
    radial-gradient(1100px 480px at 50% -10%, color-mix(in srgb, var(--brand) 7%, transparent), transparent),
    var(--bg);
}

/* Messages */
.msg-group{ display:flex; gap:10px; margin-bottom:14px; align-items:flex-start; max-width:88% }
.msg-group.user{ margin-left:auto; flex-direction:row-reverse }
.avatar{
  flex:0 0 auto; width:28px; height:28px; border-radius:50%; display:grid; place-items:center;
  font-size:12px; font-weight:700; background:var(--muted); color:var(--text);
}
.msg-group.user .avatar{ background:var(--brand); color:#fff }
.bubbles{ display:flex; flex-direction:column; gap:8px }
.bubble{
  padding:12px 14px; border-radius:16px; word-wrap:break-word; white-space:pre-wrap; box-shadow:var(--shadow);
  font-family:"Inter", "SF Pro Text", -apple-system, "Segoe UI", sans-serif;
  font-weight:400; letter-spacing:-0.01em; line-height:1.5;
}

/* User bubble: purple grad + right tail */
.msg-group.user .bubble{
  background: linear-gradient(135deg, color-mix(in srgb, var(--me) 92%, #ffffff 8%), var(--me));
  color:var(--meText);
  border-top-right-radius:10px;
  position:relative; max-width:75%;
}
.msg-group.user .bubble::after{
  content:"";
  position:absolute; right:-8px; bottom:8px;
  width:0; height:0;
  border-left:8px solid color-mix(in srgb, var(--me) 92%, #ffffff 8%);
  border-top:8px solid transparent; border-bottom:8px solid transparent;
  filter:drop-shadow(0 2px 2px rgba(0,0,0,.12));
}

/* AI bubble: soft panel + left tail */
.msg-group:not(.user) .bubble{
  background:var(--bot); color:var(--text);
  border-top-left-radius:10px; position:relative; max-width:80%;
}
.msg-group:not(.user) .bubble::before{
  content:"";
  position:absolute; left:-8px; bottom:8px;
  width:0; height:0;
  border-right:8px solid var(--bot);
  border-top:8px solid transparent; border-bottom:8px solid transparent;
  filter:drop-shadow(0 2px 2px rgba(0,0,0,.06));
}

.msg-group .bubble{ line-height:1.45 }

/* Typing dots */
.typing{ display:inline-flex; gap:4px; align-items:center }
.dot{ width:6px; height:6px; border-radius:50%; background:#b7b3cc; opacity:.75; animation:bounce 1.2s infinite }
.dot:nth-child(2){ animation-delay:.2s } .dot:nth-child(3){ animation-delay:.4s }
@keyframes bounce{ 0%,80%,100%{ transform:translateY(0); opacity:.55 } 40%{ transform:translateY(-4px); opacity:1 } }

/* Composer */
.composer{
  display:flex; gap:10px; align-items:flex-end; padding:12px; border-top:1px solid var(--line); background:var(--panel)
}
.left-tools,.right-tools{ display:flex; gap:8px; align-items:center }
.attach, .tool{
  display:grid; place-items:center; width:40px; height:40px; border-radius:12px; border:1px solid var(--line);
  background:var(--muted); color:var(--text); cursor:pointer;
}
#user-input{
  flex:1; resize:none; max-height:160px; min-height:44px;
  padding:12px 14px; border:1px solid var(--line); border-radius:12px; outline:none; background:#fff; color:var(--text);
  font-family:"Inter", "SF Pro Text", -apple-system, "Segoe UI", sans-serif;
  font-weight:400; letter-spacing:-0.01em; line-height:1.5;
}
#user-input:focus{ border-color:var(--brand); box-shadow:0 0 0 3px color-mix(in srgb, var(--brand) 22%, transparent) }
.send{
  display:flex; align-items:center; gap:8px;
  padding:12px 16px; border:none; border-radius:12px; background:var(--brand); color:#fff; cursor:pointer;
  font-family:"Inter", "SF Pro Text", -apple-system, "Segoe UI", sans-serif;
  font-weight:500; letter-spacing:-0.01em; font-size:14px;
}
.send[disabled]{ opacity:.6; cursor:not-allowed }
.hint{ 
  margin:6px 12px 14px; color:var(--sub); font-size:12px;
  font-family:"Inter", "SF Pro Text", -apple-system, "Segoe UI", sans-serif;
  font-weight:400; letter-spacing:-0.01em; line-height:1.4;
}

/* Settings dialog */
.modal{ border:none; border-radius:14px; padding:0; background:var(--panel); color:var(--text); box-shadow:var(--shadow) }
.modal::backdrop{ background:rgba(0,0,0,.25) }
.modal-body{ padding:16px; min-width:320px }
.modal h3{ 
  margin:0 0 10px; 
  font-family:"Inter", "SF Pro Display", -apple-system, "Segoe UI", sans-serif;
  font-weight:500; letter-spacing:-0.02em; font-size:16px;
}
.row{ display:flex; align-items:center; justify-content:space-between; gap:12px; margin:10px 0 }
.row input{ 
  flex:0 0 180px; padding:8px 10px; border:1px solid var(--line); border-radius:10px; background:#fff; color:var(--text);
  font-family:"Inter", "SF Pro Text", -apple-system, "Segoe UI", sans-serif;
  font-weight:400; letter-spacing:-0.01em;
}
.seg{ display:inline-flex; gap:8px }
.seg button{
  padding:8px 10px; border-radius:10px; border:1px solid var(--line); background:var(--muted); color:var(--text); cursor:pointer;
  font-family:"Inter", "SF Pro Text", -apple-system, "Segoe UI", sans-serif;
  font-weight:400; letter-spacing:-0.01em; font-size:13px;
}
.btn.ghost{ 
  padding:8px 12px; border-radius:10px; border:1px solid var(--line); background:transparent; color:var(--text);
  font-family:"Inter", "SF Pro Text", -apple-system, "Segoe UI", sans-serif;
  font-weight:400; letter-spacing:-0.01em; font-size:13px;
}


/* --- Fix short-word wrapping + make bubbles size to content nicely --- */
.bubbles { align-items: flex-start; } /* be explicit */

.bubble{
  display: inline-block;          /* size to content, not full row */
  width: fit-content;              /* grow with text */
  max-width: 80ch;                 /* wrap long messages nicely */
  min-width: 2.25rem;              /* tiny floor so “Hi” stays one line */
  white-space: pre-wrap;           /* keep user newlines */
  word-break: keep-all;            /* don’t split inside words/letters */
  overflow-wrap: break-word;       /* but allow long words/URLs to wrap */
  line-height: 1.45;
}

/* keep the previous widths balanced per side (optional) */
.msg-group.user   .bubble { max-width: 75%; }
.msg-group:not(.user) .bubble { max-width: 80%; }
